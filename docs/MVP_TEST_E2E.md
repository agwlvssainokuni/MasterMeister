# MasterMeister MVP E2Eテスト実施手順

## テスト環境準備

### 前提条件

- [x] アプリケーション起動: `cd frontend && ./gradlew bootRun -Pfrontend`
- [x] 開発用SPAサーバ起動: `cd backend && npm run dev`
- [x] 開発用データベース起動: `cd devenv && docker-compose up -d`
- [x] MailPit起動確認: http://localhost:8025
- [x] アプリケーション起動確認: http://localhost:5173

---

## 4.4.1 ユーザー登録→管理者承認→ログインフロー

### A. 新規ユーザー登録

- [x] ブラウザで http://localhost:5173 にアクセス
- [x] 「新規登録」リンクをクリック
- [x] メールアドレス入力ページでテスト用メール入力
- [x] 「登録メールを送信」ボタンクリック
- [x] 成功メッセージ表示確認
- [x] MailPit (http://localhost:8025) でメール受信確認

### B. メール経由での登録完了

- [x] MailPitでメール内のリンクをクリック
- [x] パスワード設定ページに遷移することを確認
- [x] ユーザー名とパスワードを入力
- [x] 「登録完了」ボタンクリック
- [x] 登録完了メッセージ表示確認
- [x] MailPit (http://localhost:8025) でメールアドレス確認完了メール受信確認

### C. 管理者承認ワークフロー

- [x] 管理者アカウントでログイン (admin@example.com / password)
- [x] 管理者ダッシュボードに遷移
- [x] 「承認待ちユーザー」タブで新規ユーザーを確認
- [x] 「承認」ボタンをクリック
- [x] 確認ダイアログで承認を実行
- [x] ユーザーが承認待ちリストから消えることを確認
- [x] MailPit (http://localhost:8025) でアカウント承認完了メール受信確認

### D. 承認後ログイン

- [x] 管理者からログアウト
- [x] 承認されたユーザーでログイン試行
- [x] ログイン成功してダッシュボード表示確認
- [x] ユーザー情報表示確認（右上ユーザーメニュー）

---

## 4.4.2 データベース接続設定とスキーマインポート

### A. データベース接続設定

- [x] 管理者でログイン
- [x] 管理者ダッシュボード → 「データベース」タブ
- [x] 「新しい接続を追加」ボタンクリック
- [ ] 接続情報入力:
  ```
  名前: Test MySQL
  種類: MySQL
  ホスト: localhost
  ポート: 3306
  データベース名: testdb
  ユーザー名: testuser
  パスワード: testpass
  ```
- [x] 「保存」ボタンで設定保存
- [x] 「接続テスト」ボタンで接続確認

### B. スキーマインポート

- [x] 保存された接続の「スキーマ更新」ボタンクリック
- [x] インポート処理の進行状況確認
- [x] 完了メッセージ表示確認
- [x] テーブル一覧にインポートされたテーブルが表示されることを確認

---

## 4.4.3 権限設定とアクセス制御検証

### A. 権限設定

- [x] 管理者ダッシュボード → 「権限」タブ
- [x] テスト用ユーザーに対して特定テーブルのREAD権限付与
- [x] 権限設定保存確認

### B. アクセス制御検証

- [x] テストユーザーでログイン
- [x] データアクセスページに遷移
- [x] 権限のあるテーブルが表示されることを確認
- [x] 権限のないテーブルも表示されることを確認
- [x] 権限のあるテーブルをクリックしてデータ表示確認

---

## 4.4.4 テーブル/レコード閲覧とフィルタリング

### A. テーブル選択とデータ表示

- [x] データベースツリーからテーブルを選択
- [x] レコード一覧が表示されることを確認
- [x] ページネーション動作確認（次ページ/前ページ）
- [x] レコード件数表示確認

### B. フィルタリング機能

- [x] フィルターバーでカラム選択
- [x] 等価条件（=）でフィルタ適用
- [x] フィルタ結果が正しく表示されることを確認
- [x] 複数カラムでのフィルタ組み合わせテスト
- [x] 「すべてクリア」ボタンでフィルタ解除確認

### C. ソート機能

- [x] カラムヘッダークリックでソート実行
- [x] 昇順/降順の切り替え確認
- [x] ソートアイコンの表示確認
- [x] 複数カラムソートの動作確認

### D. 横スクロール・固定列

- [x] 多くのカラムがあるテーブルで横スクロール確認
- [x] 操作列が左端に固定されることを確認
- [x] 主キー列が固定されることを確認（該当する場合）

---

## 期待される結果

### 成功基準

- [x] 全ての操作がエラーなく実行される
- [x] 権限制御が正しく動作する
- [x] UI/UXが直感的で操作しやすい
- [x] パフォーマンスが許容範囲内
- [x] 監査ログが適切に記録される

### 失敗時の対応

- 各ステップでエラーが発生した場合は詳細を記録
- ブラウザコンソールエラーの確認
- サーバーログ確認: `./gradlew bootRun` 出力
- 問題の詳細を開発者に報告

---

## 補足情報

### デフォルトアカウント

- **管理者**: admin@example.com / password
- **テストユーザー**: 登録フローで作成

### アクセスURL

- **フロントエンド**: http://localhost:5173
- **バックエンドAPI**: http://localhost:8080
- **Swagger UI**: http://localhost:8080/api/swagger-ui.html
- **MailPit**: http://localhost:8025

### ログファイル

- **アプリケーションログ**: コンソール出力
- **監査ログ**: データベースのaudit_logsテーブル
