# MasterMeister MVP E2Eテスト実施手順

## テスト環境準備

### 前提条件
- [ ] アプリケーション起動: `./gradlew bootRun -Pfrontend`
- [ ] 開発用データベース起動: `cd devenv && docker-compose up -d`
- [ ] MailPit起動確認: http://localhost:8025
- [ ] アプリケーション起動確認: http://localhost:8080

---

## 4.4.1 ユーザー登録→管理者承認→ログインフロー

### A. 新規ユーザー登録
- [ ] ブラウザで http://localhost:5173 にアクセス
- [ ] 「新規登録」リンクをクリック
- [ ] メールアドレス入力ページでテスト用メール入力
- [ ] 「登録メールを送信」ボタンクリック
- [ ] 成功メッセージ表示確認
- [ ] MailPit (http://localhost:8025) でメール受信確認

### B. メール経由での登録完了
- [ ] MailPitでメール内のリンクをクリック
- [ ] パスワード設定ページに遷移することを確認
- [ ] ユーザー名とパスワードを入力
- [ ] 「登録完了」ボタンクリック
- [ ] 登録完了メッセージ表示確認
- [ ] ユーザーステータスが「承認待ち」になることを確認

### C. 管理者承認ワークフロー
- [ ] 管理者アカウントでログイン (admin@example.com / password)
- [ ] 管理者ダッシュボードに遷移
- [ ] 「承認待ちユーザー」タブで新規ユーザーを確認
- [ ] 「承認」ボタンをクリック
- [ ] 確認ダイアログで承認を実行
- [ ] ユーザーが承認待ちリストから消えることを確認
- [ ] MailPitで承認通知メール受信確認

### D. 承認後ログイン
- [ ] 管理者からログアウト
- [ ] 承認されたユーザーでログイン試行
- [ ] ログイン成功してダッシュボード表示確認
- [ ] ユーザー情報表示確認（右上ユーザーメニュー）

---

## 4.4.2 データベース接続設定とスキーマインポート

### A. データベース接続設定
- [ ] 管理者でログイン
- [ ] 管理者ダッシュボード → 「データベース」タブ
- [ ] 「新しい接続を追加」ボタンクリック
- [ ] 接続情報入力:
  ```
  名前: Test MySQL
  種類: MySQL
  ホスト: localhost
  ポート: 3306
  データベース名: testdb
  ユーザー名: root
  パスワード: rootpassword
  ```
- [ ] 「接続テスト」ボタンで接続確認
- [ ] 「保存」ボタンで設定保存

### B. スキーマインポート
- [ ] 保存された接続の「スキーマ更新」ボタンクリック
- [ ] インポート処理の進行状況確認
- [ ] 完了メッセージ表示確認
- [ ] テーブル一覧にインポートされたテーブルが表示されることを確認

---

## 4.4.3 権限設定とアクセス制御検証

### A. 権限設定
- [ ] 管理者ダッシュボード → 「権限」タブ
- [ ] テスト用ユーザーに対して特定テーブルのREAD権限付与
- [ ] 権限設定保存確認

### B. アクセス制御検証
- [ ] テストユーザーでログイン
- [ ] データアクセスページに遷移
- [ ] 権限のあるテーブルのみ表示されることを確認
- [ ] 権限のないテーブルが表示されないことを確認
- [ ] 権限のあるテーブルをクリックしてデータ表示確認

---

## 4.4.4 テーブル/レコード閲覧とフィルタリング

### A. テーブル選択とデータ表示
- [ ] データベースツリーからテーブルを選択
- [ ] レコード一覧が表示されることを確認
- [ ] ページネーション動作確認（次ページ/前ページ）
- [ ] レコード件数表示確認

### B. フィルタリング機能
- [ ] フィルターバーでカラム選択
- [ ] 等価条件（=）でフィルタ適用
- [ ] フィルタ結果が正しく表示されることを確認
- [ ] 複数カラムでのフィルタ組み合わせテスト
- [ ] 「すべてクリア」ボタンでフィルタ解除確認

### C. ソート機能
- [ ] カラムヘッダークリックでソート実行
- [ ] 昇順/降順の切り替え確認
- [ ] ソートアイコンの表示確認
- [ ] 複数カラムソートの動作確認

### D. 横スクロール・固定列
- [ ] 多くのカラムがあるテーブルで横スクロール確認
- [ ] 操作列が左端に固定されることを確認
- [ ] 主キー列が固定されることを確認（該当する場合）

---

## 期待される結果

### 成功基準
- [ ] 全ての操作がエラーなく実行される
- [ ] 権限制御が正しく動作する
- [ ] UI/UXが直感的で操作しやすい
- [ ] パフォーマンスが許容範囲内
- [ ] 監査ログが適切に記録される

### 失敗時の対応
- 各ステップでエラーが発生した場合は詳細を記録
- ブラウザコンソールエラーの確認
- サーバーログ確認: `./gradlew bootRun` 出力
- 問題の詳細を開発者に報告

---

## 補足情報

### デフォルトアカウント
- **管理者**: admin@example.com / password
- **テストユーザー**: 登録フローで作成

### アクセスURL
- **フロントエンド**: http://localhost:5173
- **バックエンドAPI**: http://localhost:8080
- **Swagger UI**: http://localhost:8080/api/swagger-ui.html
- **MailPit**: http://localhost:8025

### ログファイル
- **アプリケーションログ**: コンソール出力
- **監査ログ**: データベースのaudit_logsテーブル